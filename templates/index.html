<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legal Text Processing System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .hero-section { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 60px 0; }
        .feature-card { transition: transform 0.3s; border: none; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .feature-card:hover { transform: translateY(-5px); }
        .result-section { background: white; border-radius: 10px; padding: 20px; margin: 10px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .confidence-bar { height: 20px; background-color: #e9ecef; border-radius: 10px; overflow: hidden; }
        .confidence-fill { height: 100%; background: linear-gradient(90deg, #28a745, #ffc107, #dc3545); transition: width 0.5s ease; }
        .entity-tag { background: #e3f2fd; color: #1976d2; padding: 4px 8px; border-radius: 15px; margin: 2px; display: inline-block; }
        .loading { display: none; }
        .footer { background-color: #343a40; color: white; padding: 40px 0; margin-top: 60px; }
    </style>
</head>
<body>
    <!-- Hero Section -->
    <div class="hero-section text-center">
        <div class="container">
            <h1 class="display-4 mb-4"><i class="fas fa-scale-justice"></i> Legal Text Processing System</h1>
            <p class="lead mb-4">Advanced NLP system for legal document classification and information extraction</p>
            <p class="mb-0">Built with Machine Learning • Trained on Indian Legal Documents • Real-time Analysis</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container mt-5">
        <!-- Features Section -->
        <div class="row mb-5">
            <div class="col-md-4">
                <div class="card feature-card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-sitemap fa-3x text-primary mb-3"></i>
                        <h5>Document Classification</h5>
                        <p>Automatically classify legal documents into categories like EPF, Companies Act, TDS, Contracts</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card feature-card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-search fa-3x text-success mb-3"></i>
                        <h5>Information Extraction</h5>
                        <p>Extract key legal entities, sections, clauses, dates, and monetary amounts from documents</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card feature-card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-file-alt fa-3x text-warning mb-3"></i>
                        <h5>Text Summarization</h5>
                        <p>Generate concise summaries highlighting the most important legal provisions</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Input Section -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h4><i class="fas fa-edit"></i> Analyze Legal Document</h4>
                    </div>
                    <div class="card-body">
                        <form id="analysisForm">
                            <div class="mb-3">
                                <label for="legalText" class="form-label">Enter Legal Text:</label>
                                <textarea class="form-control" id="legalText" rows="8" 
                                    placeholder="Paste your legal document text here for analysis..."></textarea>
                            </div>
                            <div class="text-center">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="fas fa-cog"></i> Analyze Document
                                </button>
                                <button type="button" class="btn btn-secondary btn-lg ms-2" onclick="loadSample()">
                                    <i class="fas fa-file-import"></i> Load Sample
                                </button>
                            </div>
                        </form>
                        
                        <div class="loading text-center mt-3">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Processing...</span>
                            </div>
                            <p>Processing your legal document...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results" class="row mt-4" style="display: none;">
            <!-- Classification Results -->
            <div class="col-md-6">
                <div class="result-section">
                    <h5><i class="fas fa-tags text-primary"></i> Document Classification</h5>
                    <div id="classification-result"></div>
                </div>
            </div>

            <!-- Extracted Entities -->
            <div class="col-md-6">
                <div class="result-section">
                    <h5><i class="fas fa-list text-success"></i> Extracted Information</h5>
                    <div id="entities-result"></div>
                </div>
            </div>

            <!-- Document Summary -->
            <div class="col-12">
                <div class="result-section">
                    <h5><i class="fas fa-align-left text-warning"></i> Document Summary</h5>
                    <div id="summary-result"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container text-center">
            <div class="row">
                <div class="col-md-6">
                    <h5>Legal Text Processing System</h5>
                    <p>Advanced machine learning solution for legal document analysis</p>
                </div>
                <div class="col-md-6">
                    <h5>Features</h5>
                    <ul class="list-unstyled">
                        <li><i class="fas fa-check"></i> Document Classification</li>
                        <li><i class="fas fa-check"></i> Information Extraction</li>
                        <li><i class="fas fa-check"></i> Text Summarization</li>
                        <li><i class="fas fa-check"></i> Real-time Processing</li>
                    </ul>
                </div>
            </div>
            <hr>
            <p>&copy; 2025 Legal Text Processing System. Built for legal document analysis.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Sample legal texts
        const sampleTexts = [
            `The Companies Act, 2013 requires every company to maintain proper books of account. Section 128 mandates that companies shall keep books of account at their registered office. The penalty for non-compliance under Section 129 may be fine up to rupees five lakh. Annual general meeting must be held within 6 months of the financial year ending.`,
            
            `The Employees' Provident Funds Act, 1952 provides for establishment of provident funds. Under Section 6, the contribution shall be ten per cent of the basic wages. The Central Government may frame schemes under Section 5. Companies with twenty or more employees must comply with this Act.`,
            
            `Tax shall be deducted at source at the rates specified in the Income Tax Act. The concept of TDS was introduced to collect tax from the source of income. A person liable to make payment shall deduct tax and remit to Central Government within prescribed time limits.`
        ];

        function loadSample() {
            const randomSample = sampleTexts[Math.floor(Math.random() * sampleTexts.length)];
            document.getElementById('legalText').value = randomSample;
        }

        document.getElementById('analysisForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const text = document.getElementById('legalText').value.trim();
            if (!text) {
                alert('Please enter some text to analyze');
                return;
            }

            // Show loading
            document.querySelector('.loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';

            try {
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ text: text })
                });

                const result = await response.json();

                if (result.status === 'success') {
                    displayResults(result);
                } else {
                    alert('Error: ' + result.error);
                }
            } catch (error) {
                console.error('Error:', error);
                alert('An error occurred while processing the text');
            } finally {
                document.querySelector('.loading').style.display = 'none';
            }
        });

        function displayResults(result) {
            // Display classification
            const classification = result.classification;
            let classificationHtml = `
                <div class="mb-3">
                    <strong>Predicted Category:</strong> 
                    <span class="badge bg-primary fs-6">${classification.predicted_category}</span>
                </div>
                <div class="mb-3">
                    <strong>Confidence:</strong> ${(classification.confidence * 100).toFixed(1)}%
                    <div class="confidence-bar mt-2">
                        <div class="confidence-fill" style="width: ${classification.confidence * 100}%"></div>
                    </div>
                </div>
                <div>
                    <strong>All Scores:</strong>
                    <div class="mt-2">
            `;
            
            for (const [category, score] of Object.entries(classification.all_scores)) {
                classificationHtml += `
                    <div class="d-flex justify-content-between align-items-center mb-1">
                        <span>${category}:</span>
                        <span class="badge bg-secondary">${score}</span>
                    </div>
                `;
            }
            classificationHtml += '</div></div>';
            
            document.getElementById('classification-result').innerHTML = classificationHtml;

            // Display entities
            let entitiesHtml = '';
            if (Object.keys(result.entities).length > 0) {
                for (const [entityType, entities] of Object.entries(result.entities)) {
                    entitiesHtml += `
                        <div class="mb-3">
                            <strong>${entityType.charAt(0).toUpperCase() + entityType.slice(1)}:</strong><br>
                    `;
                    entities.forEach(entity => {
                        entitiesHtml += `<span class="entity-tag">${entity}</span>`;
                    });
                    entitiesHtml += '</div>';
                }
            } else {
                entitiesHtml = '<p class="text-muted">No specific entities detected</p>';
            }
            document.getElementById('entities-result').innerHTML = entitiesHtml;

            // Display summary
            let summaryHtml = '';
            if (result.summary && result.summary.length > 0) {
                summaryHtml = '<ol>';
                result.summary.forEach(sentence => {
                    summaryHtml += `<li class="mb-2">${sentence}</li>`;
                });
                summaryHtml += '</ol>';
            } else {
                summaryHtml = '<p class="text-muted">No summary available</p>';
            }
            document.getElementById('summary-result').innerHTML = summaryHtml;

            // Show results
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        // Load sample on page load
        window.onload = function() {
            loadSample();
        };
    </script>
</body>
</html>